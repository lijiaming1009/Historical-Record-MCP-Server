# Historical Record MCP Server

[![NPM Version](https://img.shields.io/npm/v/historical-record-mcp-server?style=flat-square)](https://www.npmjs.com/package/historical-record-mcp-server)
[![License](https://img.shields.io/npm/l/historical-record-mcp-server?style=flat-square)](./LICENSE)
[![Made with TypeScript](https://img.shields.io/badge/Made%20with-TypeScript-blue.svg?style=flat-square)](https://www.typescriptlang.org/)

ä¸€ä¸ªç”¨äºè®°å½•å’Œç®¡ç† AI äº¤äº’å†å²çš„æ¨¡å‹ä¸Šä¸‹æ–‡åè®® (MCP) æœåŠ¡ã€‚

---

## 1. ğŸ“– é¡¹ç›®ç®€ä»‹

**Historical Record MCP Server** æ˜¯ä¸€ä¸ªåŸºäº Node.js å’Œ TypeScript æ„å»ºçš„ç‹¬ç«‹æœåŠ¡ï¼Œæ—¨åœ¨é€šè¿‡æ¨¡å‹ä¸Šä¸‹æ–‡åè®® (MCP) æä¾›å¯é çš„å†å²è®°å½•ç®¡ç†åŠŸèƒ½ã€‚å®ƒå¯ä»¥è½»æ¾é›†æˆåˆ° Kilo Code æˆ–å…¶ä»–å®¢æˆ·ç«¯åº”ç”¨ä¸­ï¼Œå®ç°å¯¹ AI äº¤äº’å¯¹è¯çš„æŒä¹…åŒ–å­˜å‚¨ã€çµæ´»æŸ¥è¯¢å’Œæ•°æ®å¯¼å‡ºã€‚

## 2. âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ’¾ **æŒä¹…åŒ–å­˜å‚¨**: ä½¿ç”¨è½»é‡çº§çš„ `lowdb` å°†æ‰€æœ‰è®°å½•å®‰å…¨åœ°å­˜å‚¨åœ¨æœ¬åœ° `db.json` æ–‡ä»¶ä¸­ã€‚
- â• **æ·»åŠ è®°å½•**: æä¾›ç®€å•æ¥å£ï¼Œå¿«é€Ÿæ·»åŠ æ–°çš„äº¤äº’è®°å½•ã€‚
- ğŸ” **é«˜çº§æŸ¥è¯¢**:
    - **åˆ†é¡µæŸ¥è¯¢**: æ”¯æŒæŒ‰é¡µç å’Œæ¯é¡µæ•°é‡æŸ¥è¯¢ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½å¤§é‡æ•°æ®ã€‚
    - **æ—¶é—´èŒƒå›´è¿‡æ»¤**: å¯æ ¹æ®å¼€å§‹å’Œç»“æŸæ—¥æœŸ (ISO 8601 æ ¼å¼) ç­›é€‰è®°å½•ã€‚
    - **å…³é”®è¯æœç´¢**: æ”¯æŒåœ¨äº¤äº’å†…å®¹ä¸­è¿›è¡Œä¸åŒºåˆ†å¤§å°å†™çš„å…³é”®è¯æœç´¢ã€‚
- æ’åº**: æ‰€æœ‰è®°å½•é»˜è®¤æŒ‰æ—¶é—´æˆ³å€’åºæ’åˆ—ï¼Œæœ€æ–°çš„è®°å½•æ€»åœ¨æœ€å‰é¢ã€‚
- ğŸ“¤ **æ•°æ®å¯¼å‡º**: æ”¯æŒä¸€é”®å¯¼å‡ºæ‰€æœ‰ç¬¦åˆç­›é€‰æ¡ä»¶çš„è®°å½•ï¼Œå¿½ç•¥åˆ†é¡µé™åˆ¶ã€‚
- ğŸ›¡ï¸ **ç±»å‹å®‰å…¨**: ä½¿ç”¨ `Zod` å¯¹æ‰€æœ‰è¾“å…¥å‚æ•°è¿›è¡Œä¸¥æ ¼çš„æ¨¡å¼éªŒè¯ï¼Œä¿è¯æ¥å£è°ƒç”¨çš„å¥å£®æ€§ã€‚

## 3. ğŸš€ å¿«é€Ÿå…¥é—¨

è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤åœ¨ä½ çš„æœ¬åœ°ç¯å¢ƒä¸­å¯åŠ¨å¹¶è¿è¡Œæ­¤æœåŠ¡ã€‚

### ç¯å¢ƒè¦æ±‚

- [Node.js](https://nodejs.org/) (å»ºè®®ä½¿ç”¨ v18 æˆ–æ›´é«˜ç‰ˆæœ¬)
- [Git](https://git-scm.com/)

### å®‰è£…ä¸å¯åŠ¨

```bash
# 1. å…‹éš†ä»“åº“åˆ°æœ¬åœ°
git clone https://github.com/lijiaming1009/Historical-Record-MCP-Server.git

# 2. è¿›å…¥é¡¹ç›®ç›®å½•
cd Historical-Record-MCP-Server

# 3. å®‰è£…é¡¹ç›®ä¾èµ–
npm install

# 4. ç¼–è¯‘ TypeScript ä»£ç 
npm run build

# 5. å¯åŠ¨æœåŠ¡
npm start
```

æœåŠ¡å¯åŠ¨åï¼Œå®ƒä¼šé¦–å…ˆè¾“å‡ºå…ƒæ•°æ®ä¿¡æ¯ï¼Œç„¶åå¼€å§‹ç›‘å¬æ¥è‡ªæ ‡å‡†è¾“å…¥ (stdin) çš„è¯·æ±‚ã€‚

## 4. ğŸ”§ æŠ€æœ¯å®ç°

### æŠ€æœ¯é€‰å‹

- **è¿è¡Œç¯å¢ƒ**: Node.js
- **å¼€å‘è¯­è¨€**: TypeScript
- **æ ¸å¿ƒä¾èµ–**:
  - `lowdb`: ä¸€ä¸ªè½»é‡çº§çš„ JSON æ–‡ä»¶æ•°æ®åº“ï¼Œç”¨äºæ•°æ®æŒä¹…åŒ–ã€‚
  - `zod`: ç”¨äºå®šä¹‰å’ŒéªŒè¯å·¥å…·çš„è¾“å…¥/è¾“å‡ºæ¨¡å¼ã€‚
  - `uuid`: ç”¨äºä¸ºæ¯æ¡å†å²è®°å½•ç”Ÿæˆå”¯ä¸€çš„ IDã€‚

### æ¶æ„ä¸æµç¨‹

æœ¬æœåŠ¡ä½œä¸ºç‹¬ç«‹çš„åå°è¿›ç¨‹ï¼Œé€šè¿‡æ ‡å‡†è¾“å…¥/è¾“å‡º (stdio) ä¸ MCP è°ƒç”¨æ–¹è¿›è¡Œé€šä¿¡ã€‚

```mermaid
graph TD
    subgraph "å®¢æˆ·ç«¯ç¯å¢ƒ"
        A["Kilo Code ç•Œé¢ / å®¢æˆ·ç«¯"]
    end

    subgraph "MCP åŸºç¡€è®¾æ–½"
        B["MCP æ ¸å¿ƒ / è°ƒç”¨æ–¹"]
    end

    subgraph "å†å²è®°å½• MCP æœåŠ¡"
        C["Node.js è¿›ç¨‹"]
        D["å·¥å…· (æ·»åŠ /æŸ¥è¯¢)"]
        E["æ•°æ®åº“ (db.json)"]
    end

    A -- "1. è°ƒç”¨å·¥å…·" --> B
    B -- "2. è½¬å‘è¯·æ±‚ (stdio)" --> C
    C -- "3. æ‰§è¡Œå·¥å…·é€»è¾‘" --> D
    D -- "4. è®¿é—®æ•°æ®" --> E
    E -- "5. è¿”å›æ•°æ®" --> D
    D -- "6. è¿”å›ç»“æœ" --> C
    C -- "7. å‘é€å“åº” (stdio)" --> B
    B -- "8. è¿”å›æœ€ç»ˆç»“æœ" --> A
```

## 5. ğŸ“– API å‚è€ƒ

æœ¬æœåŠ¡é€šè¿‡æ ‡å‡†è¾“å…¥/è¾“å‡ºæ¥æ”¶å’Œå‘é€ JSON æ•°æ®æ¥è°ƒç”¨å·¥å…·ã€‚

### 5.1 `add_historical_record`

æ·»åŠ ä¸€æ¡æ–°çš„å†å²è®°å½•ã€‚

- **è¯·æ±‚ (Input)**:
  ```json
  {
    "id": "request-123",
    "tool": "add_historical_record",
    "input": {
      "content": { "user": "Hello", "ai": "Hi there!" }
    }
  }
  ```
- **å“åº” (Output)**:
  ```json
  {
    "id": "request-123",
    "result": {
      "success": true,
      "id": "a1b2c3d4-e5f6-7890-1234-567890abcdef"
    }
  }
  ```

### 5.2 `get_historical_records`

æŸ¥è¯¢å†å²è®°å½•ï¼Œæ”¯æŒå¤šç§è¿‡æ»¤å’Œåˆ†é¡µé€‰é¡¹ã€‚

- **å‚æ•° (Input)**:
  - `page: number` (å¯é€‰, é»˜è®¤ 1): åˆ†é¡µæŸ¥è¯¢çš„é¡µç ã€‚
  - `limit: number` (å¯é€‰, é»˜è®¤ 20): æ¯é¡µè¿”å›çš„è®°å½•æ•°ã€‚
  - `startDate: string` (å¯é€‰, ISO 8601 æ ¼å¼): æ—¶é—´èŒƒå›´æŸ¥è¯¢çš„å¼€å§‹æ—¥æœŸã€‚
  - `endDate: string` (å¯é€‰, ISO 8601 æ ¼å¼): æ—¶é—´èŒƒå›´æŸ¥è¯¢çš„ç»“æŸæ—¥æœŸã€‚
  - `keyword: string` (å¯é€‰): æ ¹æ®å†…å®¹ä¸­çš„å…³é”®è¯è¿›è¡Œæœç´¢ã€‚
  - `export: boolean` (å¯é€‰, é»˜è®¤ false): å¦‚æœä¸º `true`ï¼Œåˆ™å¿½ç•¥åˆ†é¡µï¼Œè¿”å›æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è®°å½•ã€‚

- **è¯·æ±‚ç¤ºä¾‹ (åˆ†é¡µæŸ¥è¯¢)**:
  ```json
  {
    "id": "request-456",
    "tool": "get_historical_records",
    "input": {
      "page": 1,
      "limit": 10
    }
  }
  ```

- **å“åº”ç¤ºä¾‹ (åˆ†é¡µæŸ¥è¯¢)**:
  ```json
  {
    "id": "request-456",
    "result": {
      "page": 1,
      "limit": 10,
      "total": 100,
      "data": [
        { "id": "...", "timestamp": "...", "content": "..." }
      ]
    }
  }
  ```

## 6. âš™ï¸ æŒä¹…åŒ–è¿è¡Œ (ä½¿ç”¨ PM2)

ä¸ºäº†è®©æœåŠ¡åœ¨åå°ç¨³å®šè¿è¡Œå¹¶èƒ½éšç³»ç»Ÿé‡å¯ï¼Œæ¨èä½¿ç”¨è¿›ç¨‹ç®¡ç†å·¥å…· `pm2`ã€‚

### 6.1 å®‰è£… PM2

è¿™æ˜¯ä¸€ä¸ªå…¨å±€å®‰è£…ï¼Œåªéœ€æ‰§è¡Œä¸€æ¬¡ã€‚
```bash
npm install pm2 -g
```

### 6.2 ä½¿ç”¨ PM2 å¯åŠ¨æœåŠ¡

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚æœåŠ¡å°†ä¼šåœ¨åå°å¯åŠ¨ã€‚
```bash
# --name "historical-record" ä¸ºä½ çš„æœåŠ¡è¿›ç¨‹å‘½åï¼Œæ–¹ä¾¿åç»­ç®¡ç†
pm2 start npm --name "historical-record" -- start
```

### 6.3 ç®¡ç†æœåŠ¡

```bash
pm2 list          # æŸ¥çœ‹æ‰€æœ‰ç”± pm2 ç®¡ç†çš„æœåŠ¡çŠ¶æ€
pm2 stop historical-record  # åœæ­¢æœåŠ¡
pm2 restart historical-record # é‡å¯æœåŠ¡
pm2 logs historical-record  # æŸ¥çœ‹å®æ—¶æ—¥å¿—
pm2 delete historical-record # ä» pm2 åˆ—è¡¨ä¸­ç§»é™¤æœåŠ¡
```

### 6.4 è®¾ç½®å¼€æœºè‡ªå¯

è¿è¡Œä»¥ä¸‹å‘½ä»¤åï¼Œ`pm2` ä¼šç”Ÿæˆä¸€æ¡æŒ‡ä»¤ï¼Œå¤åˆ¶å¹¶æ‰§è¡Œè¯¥æŒ‡ä»¤å³å¯ã€‚
```bash
pm2 startup
```

## 7. ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼å¦‚æœä½ æœ‰å¥½çš„æƒ³æ³•æˆ–å‘ç°äº† Bugï¼Œè¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1.  **Fork** æœ¬ä»“åº“ã€‚
2.  åˆ›å»ºä½ çš„ç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)ã€‚
3.  æäº¤ä½ çš„ä¿®æ”¹ (`git commit -m 'Add some AmazingFeature'`)ã€‚
4.  å°†ä½ çš„åˆ†æ”¯æ¨é€åˆ°è¿œç¨‹ä»“åº“ (`git push origin feature/AmazingFeature`)ã€‚
5.  **æäº¤ä¸€ä¸ª Pull Request**ã€‚

## 8. ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº [ISC License](./LICENSE) å¼€æºã€‚

## 9. ğŸ“« è”ç³»æ–¹å¼

ä½œè€…: Jiaming Li - [GitHub](https://github.com/lijiaming1009)

é¡¹ç›®é“¾æ¥: [https://github.com/lijiaming1009/Historical-Record-MCP-Server](https://github.com/lijiaming1009/Historical-Record-MCP-Server)
